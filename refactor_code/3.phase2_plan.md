# üì¶ Phase 2: Code Organization - ‡πÅ‡∏¢‡∏Å‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏ç‡πà

**‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:** 9 ‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô 2025
**‡∏à‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå:** ‡πÅ‡∏¢‡∏Å‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏ç‡πà‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏•‡πá‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡πÅ‡∏•‡∏∞‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏á‡πà‡∏≤‡∏¢
**‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì:** 7-10 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á
**‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:** üü° ‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£

---

## üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏° Phase 2

| ‡πÑ‡∏ü‡∏•‡πå | ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î | Priority | ‡πÅ‡∏¢‡∏Å‡πÄ‡∏õ‡πá‡∏ô | ‡πÄ‡∏ß‡∏•‡∏≤ |
|------|--------|----------|---------|------|
| üî¥ chatStore.ts | 995 | ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î | 7 ‡πÑ‡∏ü‡∏•‡πå | 3-4 ‡∏ä‡∏° |
| üü† sidebar.tsx | 726 | ‡∏™‡∏π‡∏á | 15 ‡πÑ‡∏ü‡∏•‡πå | 2-3 ‡∏ä‡∏° |
| üü° chatWebSocket.ts | 559 | ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á | 5 ‡πÑ‡∏ü‡∏•‡πå | 2-3 ‡∏ä‡∏° |
| **‡∏£‡∏ß‡∏°** | **2,280 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î** | - | **27 ‡πÑ‡∏ü‡∏•‡πå** | **7-10 ‡∏ä‡∏°** |

---

## üéØ ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ Phase 2

### ‚úÖ ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö
- ‚úÖ **‡πÅ‡∏¢‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö** - ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏µ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô (Single Responsibility)
- ‚úÖ **‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô** - ‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏±‡πâ‡∏ô‡∏•‡∏á ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÑ‡∏î‡πâ‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô
- ‚úÖ **‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏á‡πà‡∏≤‡∏¢** - ‡πÅ‡∏Å‡πâ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏™‡πà‡∏ß‡∏ô‡∏≠‡∏∑‡πà‡∏ô
- ‚úÖ **Test ‡∏á‡πà‡∏≤‡∏¢** - ‡πÅ‡∏¢‡∏Å test ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏î‡πâ
- ‚úÖ **Reuse ‡πÑ‡∏î‡πâ** - ‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏ó‡∏µ‡πà‡∏≠‡∏∑‡πà‡∏ô‡πÑ‡∏î‡πâ
- ‚úÖ **‡∏Ç‡∏¢‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢** - ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏°‡πà‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô

### üé® ‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£ Refactor
1. **Extract Functions** - ‡πÅ‡∏¢‡∏Å functions ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏Å‡∏±‡∏ô‡∏≠‡∏≠‡∏Å‡∏°‡∏≤
2. **Extract Types** - ‡πÅ‡∏¢‡∏Å type definitions ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å implementation
3. **Extract Constants** - ‡πÅ‡∏¢‡∏Å config ‡πÅ‡∏•‡∏∞ constants ‡∏≠‡∏≠‡∏Å‡∏°‡∏≤
4. **Group by Feature** - ‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ï‡∏≤‡∏° feature ‡πÅ‡∏ó‡∏ô layer
5. **Single Responsibility** - 1 ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏≥ 1 ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á

---

## üî¥ Task 1: ‡πÅ‡∏¢‡∏Å chatStore.ts (995 ‚Üí 7 ‡πÑ‡∏ü‡∏•‡πå)

### üìù ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‚¨ú ‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£
### ‚è±Ô∏è ‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì: 3-4 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á

### üéØ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà

```
lib/stores/chat/
‚îú‚îÄ‚îÄ index.ts                      # ‚úÖ Export ‡∏´‡∏•‡∏±‡∏Å (20 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
‚îú‚îÄ‚îÄ chatStore.ts                  # ‚úÖ Zustand store + state (150 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
‚îú‚îÄ‚îÄ chatTypes.ts                  # ‚úÖ Type definitions (150 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
‚îú‚îÄ‚îÄ chatSelectors.ts              # ‚úÖ Selectors (100 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
‚îú‚îÄ‚îÄ actions/
‚îÇ   ‚îú‚îÄ‚îÄ conversationActions.ts    # ‚úÖ Conversation CRUD (200 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
‚îÇ   ‚îú‚îÄ‚îÄ messageActions.ts         # ‚úÖ Message CRUD (200 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
‚îÇ   ‚îî‚îÄ‚îÄ onlineStatusActions.ts    # ‚úÖ Online status (100 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
‚îî‚îÄ‚îÄ helpers/
    ‚îú‚îÄ‚îÄ messageHelpers.ts         # ‚úÖ Message utilities (100 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
    ‚îî‚îÄ‚îÄ conversationHelpers.ts    # ‚úÖ Conversation utilities (100 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
```

### üìã Checklist: chatStore Refactor

#### Step 1: ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå (5 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `lib/stores/chat/` folder
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `lib/stores/chat/actions/` folder
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `lib/stores/chat/helpers/` folder

#### Step 2: ‡πÅ‡∏¢‡∏Å Types (30 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `chatTypes.ts`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `ChatState` interface
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `Conversation` interface
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `Message` interface
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `OnlineStatus` type
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `SendMessageData` interface
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ type ‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
- [ ] Test import types ‡πÉ‡∏ô chatStore

#### Step 3: ‡πÅ‡∏¢‡∏Å Helpers (30 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `helpers/messageHelpers.ts`
  - [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `sortMessages()`
  - [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `formatMessageTime()`
  - [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `groupMessagesByDate()`
  - [ ] ‡∏¢‡πâ‡∏≤‡∏¢ helper functions ‡∏≠‡∏∑‡πà‡∏ô‡πÜ

- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `helpers/conversationHelpers.ts`
  - [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `sortConversations()`
  - [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `findConversationById()`
  - [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `calculateUnreadCount()`
  - [ ] ‡∏¢‡πâ‡∏≤‡∏¢ helper functions ‡∏≠‡∏∑‡πà‡∏ô‡πÜ

#### Step 4: ‡πÅ‡∏¢‡∏Å Actions - Conversations (45 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `actions/conversationActions.ts`
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `createConversationActions()` function
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `fetchConversations()`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `createConversation()`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `deleteConversation()`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `clearConversation()`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `searchUsers()`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `blockUser()`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `unblockUser()`
- [ ] Test conversation actions

#### Step 5: ‡πÅ‡∏¢‡∏Å Actions - Messages (45 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `actions/messageActions.ts`
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `createMessageActions()` function
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `fetchMessages()`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `sendMessage()`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `sendFileMessage()`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `deleteMessage()`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `markAsRead()`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `markConversationAsRead()`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `addMessage()` (for WebSocket)
- [ ] Test message actions

#### Step 6: ‡πÅ‡∏¢‡∏Å Actions - Online Status (20 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `actions/onlineStatusActions.ts`
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `createOnlineStatusActions()` function
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `setUserOnline()`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `setUserOffline()`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `setTyping()`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `clearTyping()`
- [ ] Test online status actions

#### Step 7: ‡πÅ‡∏¢‡∏Å Selectors (30 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `chatSelectors.ts`
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `getConversationById()`
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `getMessagesByConversationId()`
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `getUnreadCount()`
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `isUserOnline()`
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `getTypingUsers()`
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á selector ‡∏≠‡∏∑‡πà‡∏ô‡πÜ
- [ ] Export selectors ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

#### Step 8: ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á chatStore.ts (30 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] Import types ‡∏à‡∏≤‡∏Å `chatTypes.ts`
- [ ] Import helpers ‡∏à‡∏≤‡∏Å `helpers/`
- [ ] Import actions ‡∏à‡∏≤‡∏Å `actions/`
- [ ] ‡πÉ‡∏ä‡πâ `...createConversationActions(set, get)`
- [ ] ‡πÉ‡∏ä‡πâ `...createMessageActions(set, get)`
- [ ] ‡πÉ‡∏ä‡πâ `...createOnlineStatusActions(set, get)`
- [ ] ‡∏•‡∏ö code ‡∏ó‡∏µ‡πà‡∏¢‡πâ‡∏≤‡∏¢‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß
- [ ] ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÅ‡∏Ñ‡πà state definition

#### Step 9: ‡∏™‡∏£‡πâ‡∏≤‡∏á index.ts (15 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `lib/stores/chat/index.ts`
- [ ] Export `useChatStore`
- [ ] Export types ‡∏à‡∏≤‡∏Å `chatTypes.ts`
- [ ] Export selectors ‡∏à‡∏≤‡∏Å `chatSelectors.ts`
- [ ] Export helpers (optional)

#### Step 10: ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Imports ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏≠‡∏∑‡πà‡∏ô (30 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] ‡∏´‡∏≤ files ‡∏ó‡∏µ‡πà import ‡∏à‡∏≤‡∏Å `lib/stores/chatStore`
- [ ] ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏õ‡πá‡∏ô `lib/stores/chat`
- [ ] ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ import types ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

#### Step 11: Testing (30 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] Run TypeScript check: `npx tsc --noEmit`
- [ ] Test chat features ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:
  - [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á conversation ‡πÉ‡∏´‡∏°‡πà
  - [ ] ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
  - [ ] ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
  - [ ] ‡∏ó‡∏≥‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏ß‡πà‡∏≤‡∏≠‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß
  - [ ] Online status
  - [ ] Typing indicator
- [ ] ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö console errors
- [ ] ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö WebSocket connection

#### Step 12: Cleanup (15 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] ‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏Å‡πà‡∏≤ `lib/stores/chatStore.ts`
- [ ] ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ import ‡πÄ‡∏Å‡πà‡∏≤‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏≠‡∏¢‡∏π‡πà
- [ ] Commit changes

### üí° ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: chatStore.ts (‡∏Å‡πà‡∏≠‡∏ô ‚Üí ‡∏´‡∏•‡∏±‡∏á)

#### ‚ùå ‡∏Å‡πà‡∏≠‡∏ô: chatStore.ts (995 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
```typescript
// lib/stores/chatStore.ts
import { create } from 'zustand';

// Types (150+ lines)
export interface ChatState {
  conversations: Conversation[];
  messages: Record<string, Message[]>;
  // ... more types
}

// Store (845+ lines)
export const useChatStore = create<ChatState>((set, get) => ({
  // State
  conversations: [],
  messages: {},
  onlineUsers: new Set(),

  // Conversation Actions (200+ lines)
  fetchConversations: async () => {
    // 50 lines of code
  },

  createConversation: async (username: string) => {
    // 40 lines of code
  },

  deleteConversation: async (id: string) => {
    // 30 lines of code
  },

  // Message Actions (200+ lines)
  fetchMessages: async (conversationId: string) => {
    // 80 lines of code
  },

  sendMessage: async (data: SendMessageData) => {
    // 100 lines of code
  },

  deleteMessage: async (id: string) => {
    // 30 lines of code
  },

  // Online Status Actions (100+ lines)
  setUserOnline: (userId: string) => {
    // 20 lines of code
  },

  // ... 20+ more methods
}));
```

#### ‚úÖ ‡∏´‡∏•‡∏±‡∏á: ‡πÅ‡∏¢‡∏Å‡πÄ‡∏õ‡πá‡∏ô 7 ‡πÑ‡∏ü‡∏•‡πå

**1. chatTypes.ts (150 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)**
```typescript
// lib/stores/chat/chatTypes.ts
export interface ChatState {
  conversations: Conversation[];
  messages: Record<string, Message[]>;
  onlineUsers: Set<string>;
  typingUsers: Record<string, string[]>;
  unreadCount: number;
  isLoading: boolean;

  // Actions
  ...ConversationActions;
  ...MessageActions;
  ...OnlineStatusActions;
}

export interface Conversation {
  id: string;
  participants: User[];
  lastMessage: Message | null;
  unreadCount: number;
  createdAt: string;
  updatedAt: string;
}

export interface Message {
  id: string;
  conversationId: string;
  sender: User;
  content: string;
  fileUrl?: string;
  fileName?: string;
  fileSize?: number;
  createdAt: string;
  isRead: boolean;
}

// ... more types
```

**2. chatStore.ts (150 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î) - ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÅ‡∏Ñ‡πà state**
```typescript
// lib/stores/chat/chatStore.ts
import { create } from 'zustand';
import { ChatState } from './chatTypes';
import { createConversationActions } from './actions/conversationActions';
import { createMessageActions } from './actions/messageActions';
import { createOnlineStatusActions } from './actions/onlineStatusActions';

export const useChatStore = create<ChatState>((set, get) => ({
  // ‚úÖ State only (clean!)
  conversations: [],
  messages: {},
  onlineUsers: new Set(),
  typingUsers: {},
  unreadCount: 0,
  isLoading: false,

  // ‚úÖ Actions from external files
  ...createConversationActions(set, get),
  ...createMessageActions(set, get),
  ...createOnlineStatusActions(set, get),
}));
```

**3. actions/conversationActions.ts (200 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)**
```typescript
// lib/stores/chat/actions/conversationActions.ts
import type { StateCreator } from 'zustand';
import type { ChatState, Conversation } from '../chatTypes';
import { chatService } from '@/lib/services/api/chat.service';

export interface ConversationActions {
  fetchConversations: () => Promise<void>;
  createConversation: (username: string) => Promise<Conversation>;
  deleteConversation: (id: string) => Promise<void>;
  clearConversation: (id: string) => Promise<void>;
  // ... more actions
}

export const createConversationActions = (
  set: any,
  get: () => ChatState
): ConversationActions => ({
  fetchConversations: async () => {
    try {
      set({ isLoading: true });
      const conversations = await chatService.getConversations();
      set({ conversations, isLoading: false });
    } catch (error) {
      set({ isLoading: false });
      throw error;
    }
  },

  createConversation: async (username: string) => {
    const conversation = await chatService.createConversation(username);
    set((state) => ({
      conversations: [conversation, ...state.conversations],
    }));
    return conversation;
  },

  deleteConversation: async (id: string) => {
    await chatService.deleteConversation(id);
    set((state) => ({
      conversations: state.conversations.filter((c) => c.id !== id),
    }));
  },

  // ... more actions
});
```

**4. actions/messageActions.ts (200 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)**
```typescript
// lib/stores/chat/actions/messageActions.ts
import type { ChatState, Message, SendMessageData } from '../chatTypes';
import { chatService } from '@/lib/services/api/chat.service';
import { sortMessages } from '../helpers/messageHelpers';

export interface MessageActions {
  fetchMessages: (conversationId: string) => Promise<void>;
  sendMessage: (data: SendMessageData) => Promise<Message>;
  deleteMessage: (messageId: string, conversationId: string) => Promise<void>;
  markAsRead: (conversationId: string) => Promise<void>;
  addMessage: (message: Message) => void; // for WebSocket
}

export const createMessageActions = (
  set: any,
  get: () => ChatState
): MessageActions => ({
  fetchMessages: async (conversationId: string) => {
    const messages = await chatService.getMessages(conversationId);
    set((state) => ({
      messages: {
        ...state.messages,
        [conversationId]: sortMessages(messages),
      },
    }));
  },

  sendMessage: async (data: SendMessageData) => {
    const message = await chatService.sendMessage(data);
    set((state) => ({
      messages: {
        ...state.messages,
        [data.conversationId]: [
          ...(state.messages[data.conversationId] || []),
          message,
        ],
      },
    }));
    return message;
  },

  // ... more actions
});
```

**5. actions/onlineStatusActions.ts (100 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)**
```typescript
// lib/stores/chat/actions/onlineStatusActions.ts
import type { ChatState } from '../chatTypes';

export interface OnlineStatusActions {
  setUserOnline: (userId: string) => void;
  setUserOffline: (userId: string) => void;
  setTyping: (conversationId: string, userId: string) => void;
  clearTyping: (conversationId: string, userId: string) => void;
}

export const createOnlineStatusActions = (
  set: any,
  get: () => ChatState
): OnlineStatusActions => ({
  setUserOnline: (userId: string) => {
    set((state) => ({
      onlineUsers: new Set([...state.onlineUsers, userId]),
    }));
  },

  setUserOffline: (userId: string) => {
    set((state) => {
      const newSet = new Set(state.onlineUsers);
      newSet.delete(userId);
      return { onlineUsers: newSet };
    });
  },

  // ... more actions
});
```

**6. helpers/messageHelpers.ts (100 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)**
```typescript
// lib/stores/chat/helpers/messageHelpers.ts
import type { Message } from '../chatTypes';

export const sortMessages = (messages: Message[]): Message[] => {
  return [...messages].sort(
    (a, b) => new Date(a.createdAt).getTime() - new Date(b.createdAt).getTime()
  );
};

export const groupMessagesByDate = (messages: Message[]) => {
  // Implementation
};

export const formatMessageTime = (date: string) => {
  // Implementation
};

// ... more helpers
```

**7. helpers/conversationHelpers.ts (100 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)**
```typescript
// lib/stores/chat/helpers/conversationHelpers.ts
import type { Conversation } from '../chatTypes';

export const sortConversations = (conversations: Conversation[]): Conversation[] => {
  return [...conversations].sort(
    (a, b) =>
      new Date(b.updatedAt).getTime() - new Date(a.updatedAt).getTime()
  );
};

export const calculateUnreadCount = (conversations: Conversation[]): number => {
  return conversations.reduce((total, conv) => total + conv.unreadCount, 0);
};

// ... more helpers
```

**8. index.ts (20 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)**
```typescript
// lib/stores/chat/index.ts
export { useChatStore } from './chatStore';
export type * from './chatTypes';
export * from './chatSelectors';
```

---

## üü† Task 2: ‡πÅ‡∏¢‡∏Å sidebar.tsx (726 ‚Üí 15 ‡πÑ‡∏ü‡∏•‡πå)

### üìù ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‚¨ú ‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£
### ‚è±Ô∏è ‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì: 2-3 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á

### üéØ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà

```
components/ui/sidebar/
‚îú‚îÄ‚îÄ index.ts                      # ‚úÖ Re-export (30 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
‚îú‚îÄ‚îÄ constants.ts                  # ‚úÖ Config values (40 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
‚îú‚îÄ‚îÄ types.ts                      # ‚úÖ Type definitions (50 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
‚îú‚îÄ‚îÄ SidebarContext.tsx            # ‚úÖ Context + hooks (150 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
‚îú‚îÄ‚îÄ SidebarProvider.tsx           # ‚úÖ Provider component (120 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
‚îú‚îÄ‚îÄ Sidebar.tsx                   # ‚úÖ Main sidebar (100 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
‚îú‚îÄ‚îÄ SidebarMenu.tsx               # ‚úÖ Menu components (150 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
‚îî‚îÄ‚îÄ components/
    ‚îú‚îÄ‚îÄ SidebarHeader.tsx         # ‚úÖ Header (50 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
    ‚îú‚îÄ‚îÄ SidebarContent.tsx        # ‚úÖ Content (50 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
    ‚îú‚îÄ‚îÄ SidebarFooter.tsx         # ‚úÖ Footer (50 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
    ‚îú‚îÄ‚îÄ SidebarGroup.tsx          # ‚úÖ Group (60 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
    ‚îú‚îÄ‚îÄ SidebarGroupLabel.tsx     # ‚úÖ Group label (30 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
    ‚îú‚îÄ‚îÄ SidebarGroupContent.tsx   # ‚úÖ Group content (30 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
    ‚îú‚îÄ‚îÄ SidebarTrigger.tsx        # ‚úÖ Trigger (40 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
    ‚îú‚îÄ‚îÄ SidebarRail.tsx           # ‚úÖ Rail (30 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
    ‚îî‚îÄ‚îÄ SidebarInset.tsx          # ‚úÖ Inset (30 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
```

### üìã Checklist: sidebar Refactor

#### Step 1: ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á (5 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `components/ui/sidebar/` folder
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `components/ui/sidebar/components/` folder

#### Step 2: ‡πÅ‡∏¢‡∏Å Constants (15 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `constants.ts`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `SIDEBAR_COOKIE_NAME`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `SIDEBAR_COOKIE_MAX_AGE`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `SIDEBAR_WIDTH`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `SIDEBAR_WIDTH_MOBILE`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `SIDEBAR_WIDTH_ICON`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `SIDEBAR_KEYBOARD_SHORTCUT`

#### Step 3: ‡πÅ‡∏¢‡∏Å Types (15 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `types.ts`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `SidebarContext` type
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `SidebarState` type
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ component prop types
- [ ] Export types ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

#### Step 4: ‡πÅ‡∏¢‡∏Å Context (30 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `SidebarContext.tsx`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `createContext` logic
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `useSidebar` hook
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `useIsMobile` hook
- [ ] Export context + hooks

#### Step 5: ‡πÅ‡∏¢‡∏Å Provider (30 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `SidebarProvider.tsx`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ provider logic
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ state management
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ keyboard shortcuts
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ cookie handling

#### Step 6: ‡πÅ‡∏¢‡∏Å Components (60 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `components/SidebarHeader.tsx`
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `components/SidebarContent.tsx`
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `components/SidebarFooter.tsx`
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `components/SidebarGroup.tsx`
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `components/SidebarGroupLabel.tsx`
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `components/SidebarGroupContent.tsx`
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `components/SidebarTrigger.tsx`
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `components/SidebarRail.tsx`
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `components/SidebarInset.tsx`

#### Step 7: ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á Main Files (20 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `Sidebar.tsx` (main component)
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `SidebarMenu.tsx` (menu components)
- [ ] Import ‡∏à‡∏≤‡∏Å components/

#### Step 8: ‡∏™‡∏£‡πâ‡∏≤‡∏á index.ts (10 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `index.ts`
- [ ] Export ‡∏ó‡∏∏‡∏Å component
- [ ] Export context + hooks
- [ ] Export types

#### Step 9: ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Imports (30 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] ‡∏´‡∏≤ files ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ sidebar
- [ ] ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï imports ‡πÄ‡∏õ‡πá‡∏ô `@/components/ui/sidebar`
- [ ] ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö imports ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

#### Step 10: Testing (20 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] Run TypeScript check
- [ ] Test sidebar open/close
- [ ] Test mobile responsive
- [ ] Test keyboard shortcuts
- [ ] Test cookie persistence

#### Step 11: Cleanup (10 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] ‡∏•‡∏ö `components/ui/sidebar.tsx` ‡πÄ‡∏Å‡πà‡∏≤
- [ ] Commit changes

---

## üü° Task 3: ‡πÅ‡∏¢‡∏Å chatWebSocket.ts (559 ‚Üí 5 ‡πÑ‡∏ü‡∏•‡πå)

### üìù ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‚¨ú ‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£
### ‚è±Ô∏è ‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì: 2-3 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á

### üéØ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà

```
lib/services/websocket/
‚îú‚îÄ‚îÄ index.ts                      # ‚úÖ Export (10 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
‚îú‚îÄ‚îÄ config.ts                     # ‚úÖ WebSocket config (50 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
‚îú‚îÄ‚îÄ chatWebSocket.ts              # ‚úÖ Main client (200 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
‚îú‚îÄ‚îÄ connectionManager.ts          # ‚úÖ Reconnection logic (100 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
‚îú‚îÄ‚îÄ messageRouter.ts              # ‚úÖ Message routing (150 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
‚îî‚îÄ‚îÄ notificationHandler.ts        # ‚úÖ Browser notifications (100 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
```

### üìã Checklist: chatWebSocket Refactor

#### Step 1: ‡πÅ‡∏¢‡∏Å Config (20 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `config.ts`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `MAX_RECONNECT_ATTEMPTS`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `RECONNECT_DELAY`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `PING_INTERVAL`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ `MESSAGE_QUEUE_SIZE`
- [ ] Export config object

#### Step 2: ‡πÅ‡∏¢‡∏Å Connection Manager (45 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `connectionManager.ts`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ reconnection logic
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ ping/pong handling
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ connection state management
- [ ] Export `ConnectionManager` class

#### Step 3: ‡πÅ‡∏¢‡∏Å Message Router (45 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `messageRouter.ts`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ message type routing
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ message handlers
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ event dispatching
- [ ] Export `MessageRouter` class

#### Step 4: ‡πÅ‡∏¢‡∏Å Notification Handler (30 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á `notificationHandler.ts`
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ browser notification logic
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ permission handling
- [ ] ‡∏¢‡πâ‡∏≤‡∏¢ notification formatting
- [ ] Export `NotificationHandler` class

#### Step 5: ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á chatWebSocket.ts (45 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] Import config
- [ ] Import ConnectionManager
- [ ] Import MessageRouter
- [ ] Import NotificationHandler
- [ ] ‡πÉ‡∏ä‡πâ external classes
- [ ] ‡∏•‡∏ö code ‡∏ó‡∏µ‡πà‡∏¢‡πâ‡∏≤‡∏¢‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß

#### Step 6: ‡∏™‡∏£‡πâ‡∏≤‡∏á index.ts (10 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] Export `ChatWebSocket`
- [ ] Export types
- [ ] Export config (optional)

#### Step 7: Testing (30 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] Test WebSocket connection
- [ ] Test reconnection
- [ ] Test message sending
- [ ] Test message receiving
- [ ] Test notifications
- [ ] Test typing indicators

#### Step 8: Cleanup (10 ‡∏ô‡∏≤‡∏ó‡∏µ)
- [ ] ‡∏•‡∏ö comments ‡πÄ‡∏Å‡πà‡∏≤
- [ ] Commit changes

---

## üìä ‡∏™‡∏£‡∏∏‡∏õ Progress Phase 2

### Task Summary

| Task | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | Progress | ‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ä‡πâ | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ |
|------|-------|----------|---------|----------|
| üî¥ chatStore.ts | ‚¨ú Todo | 0% | 0/4 ‡∏ä‡∏° | - |
| üü† sidebar.tsx | ‚¨ú Todo | 0% | 0/3 ‡∏ä‡∏° | - |
| üü° chatWebSocket.ts | ‚¨ú Todo | 0% | 0/3 ‡∏ä‡∏° | - |
| **Total** | ‚¨ú | **0%** | **0/10 ‡∏ä‡∏°** | - |

### Overall Progress
```
Phase 2: Code Organization
[‚¨ú‚¨ú‚¨ú‚¨ú‚¨ú‚¨ú‚¨ú‚¨ú‚¨ú‚¨ú] 0%

üî¥ chatStore.ts      [‚¨ú‚¨ú‚¨ú‚¨ú‚¨ú] 0% (0/7 files)
üü† sidebar.tsx       [‚¨ú‚¨ú‚¨ú‚¨ú‚¨ú] 0% (0/15 files)
üü° chatWebSocket.ts  [‚¨ú‚¨ú‚¨ú‚¨ú‚¨ú] 0% (0/5 files)
```

---

## üéØ ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥

### ‡πÅ‡∏ö‡∏ö Sequential (‡∏ó‡∏µ‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå)
1. **Day 1: chatStore.ts** (3-4 ‡∏ä‡∏°)
   - ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏ä‡πâ‡∏≤: Steps 1-4 (Types, Helpers, Conversation Actions)
   - ‡∏ö‡πà‡∏≤‡∏¢: Steps 5-7 (Message Actions, Online Actions, Selectors)
   - ‡πÄ‡∏¢‡πá‡∏ô: Steps 8-12 (Integration, Testing, Cleanup)

2. **Day 2: sidebar.tsx** (2-3 ‡∏ä‡∏°)
   - ‡πÄ‡∏ä‡πâ‡∏≤: Steps 1-5 (Structure, Constants, Types, Context, Provider)
   - ‡∏ö‡πà‡∏≤‡∏¢: Steps 6-11 (Components, Testing, Cleanup)

3. **Day 3: chatWebSocket.ts** (2-3 ‡∏ä‡∏°)
   - ‡πÄ‡∏ä‡πâ‡∏≤: Steps 1-4 (Config, Connection, Router, Notifications)
   - ‡∏ö‡πà‡∏≤‡∏¢: Steps 5-8 (Integration, Testing, Cleanup)

### ‡πÅ‡∏ö‡∏ö Parallel (‡πÅ‡∏ö‡πà‡∏á‡∏Ñ‡∏ô)
- **Person A**: chatStore.ts (4 ‡∏ä‡∏°)
- **Person B**: sidebar.tsx (3 ‡∏ä‡∏°)
- **Person C**: chatWebSocket.ts (3 ‡∏ä‡∏°)

---

## ‚úÖ Definition of Done

‡πÅ‡∏ï‡πà‡∏•‡∏∞ Task ‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠:

- [x] ‡πÅ‡∏¢‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏ï‡∏≤‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ß‡∏≤‡∏á‡πÑ‡∏ß‡πâ
- [x] ‡∏ó‡∏∏‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 200 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î
- [x] TypeScript compilation ‡∏ú‡πà‡∏≤‡∏ô (no errors)
- [x] ‡∏ó‡∏∏‡∏Å features ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°
- [x] Import paths ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏°‡∏î
- [x] ‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏Å‡πà‡∏≤‡πÅ‡∏•‡πâ‡∏ß
- [x] Commit changes ‡∏û‡∏£‡πâ‡∏≠‡∏° message ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
- [x] ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï checklist ‡πÄ‡∏õ‡πá‡∏ô ‚úÖ

---

## üìù Notes & Tips

### üí° Best Practices
1. **‡∏ó‡∏≥‡∏ó‡∏µ‡∏•‡∏∞ Task** - ‡∏≠‡∏¢‡πà‡∏≤‡πÄ‡∏£‡πà‡∏á‡∏ó‡∏≥‡∏´‡∏•‡∏≤‡∏¢‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô
2. **Test ‡∏ö‡πà‡∏≠‡∏¢‡πÜ** - ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏¢‡∏Å‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡πâ test ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
3. **Commit ‡∏ö‡πà‡∏≠‡∏¢** - Commit ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà Steps ‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏™‡∏£‡πá‡∏à
4. **Keep Backup** - ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏Å‡πà‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏•‡∏ö
5. **Read Carefully** - ‡∏≠‡πà‡∏≤‡∏ô code ‡πÄ‡∏î‡∏¥‡∏°‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏¢‡∏Å

### ‚ö†Ô∏è Common Pitfalls
1. **Circular Dependencies** - ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏Å‡∏≤‡∏£ import ‡∏Å‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏á
2. **Missing Exports** - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö export ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏≠‡∏±‡∏ô
3. **Type Errors** - ‡∏£‡∏∞‡∏ß‡∏±‡∏á type imports/exports
4. **State Management** - ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á state ‡πÉ‡∏ô Zustand
5. **WebSocket Connection** - ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á reconnection logic

### üîß Debugging Tips
- ‡πÉ‡∏ä‡πâ `npx tsc --noEmit` ‡∏ö‡πà‡∏≠‡∏¢‡πÜ
- ‡πÄ‡∏õ‡∏¥‡∏î DevTools Console ‡∏ï‡∏•‡∏≠‡∏î
- Test ‡∏ó‡∏∏‡∏Å feature ‡∏´‡∏•‡∏±‡∏á refactor
- ‡πÉ‡∏ä‡πâ Git diff ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á

---

## üìÖ Timeline ‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥

```
Week 1: Phase 2 Execution
‚îú‚îÄ‚îÄ Mon: chatStore.ts (Tasks 1-6)
‚îú‚îÄ‚îÄ Tue: chatStore.ts (Tasks 7-12) + Testing
‚îú‚îÄ‚îÄ Wed: sidebar.tsx (Tasks 1-8)
‚îú‚îÄ‚îÄ Thu: sidebar.tsx (Tasks 9-11) + chatWebSocket.ts (Tasks 1-4)
‚îî‚îÄ‚îÄ Fri: chatWebSocket.ts (Tasks 5-8) + Final Testing

Week 2: Phase 3 (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
‚îî‚îÄ‚îÄ TBD
```

---

**‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î:** 9 ‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô 2025
**Next Update:** ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏° Task ‡πÅ‡∏£‡∏Å
